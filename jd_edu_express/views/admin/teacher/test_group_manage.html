<% include ../header.html %>
<link href="//cdn.bootcss.com/element-ui/1.2.4/theme-default/index.css" rel="stylesheet">
<style>
  .step1 .title {
    text-align: center;
    margin:15px auto;
    font-size: 16px;
  }

</style>

<div id="group" class="wrapper wrapper-content">
    <div class="row" style="background-color: white;padding:15px;">
      　<!--表格工具栏-->
      　<div id="toolbar">
      　        <button class="btn btn-primary" type="button" onclick="getGrouoList()"><i class="fa fa-refresh"></i>&nbsp;刷新</button>
      　        <button id="btn_add" type="button" class="btn btn-primary"><i class="fa fa-plus"></i>&nbsp;新建分组</button>
      　    </form>
      　</div>
        <div class="ibox float-e-margins" style="margin-top:15px;">
          <el-table
            :data="groupList"
            border
            style="width: 100%"
            @selection-change="handleSelectionChange">
            <el-table-column
              type="index"
              width="50">
            </el-table-column>
            <el-table-column
              prop="group_name"
              label="分组名"
              >
            </el-table-column>
            <el-table-column
              prop="member_count"
              label="分组人数"
            >
            </el-table-column>
            <el-table-column
              label="操作"
              width="100">
              <template scope="scope">
                <el-button type="text" size="small">详情</el-button>
                <el-button @click="deleteGroup()" type="text" size="small">删除</el-button>
              </template>
            </el-table-column>
          </el-table>
        </div>
    </div>
</div>



<div id="app">
    <div id="add_group_edit" class="container" hidden="hidden">
        <div class="panel panel-primary">
            <div class="panel-body">
                <form class="form-horizontal">
                    <div class="step1">
                        <div id="ptype" class="col-md-12"></div>
                        <div class="col-md-12">
                            <label class="col-md-12 control-label title">分组名称</label>
                            <div class="col-md-12">
                                <input class="form-control" style="text-align: center;" type="text" placeholder="给新建的分组，取个名称吧">
                            </div>
                        </div>
                    </div>
                    <div class="step1">
                      <div class="col-md-12">
                          <label class="col-md-12 control-label title">添加人员</label>
                          <div class="col-md-12">
                              <div>
                                <el-table
                                  :data="studentList"
                                  border
                                  style="width: 100%"
                                  @selection-change="handleSelectionChange">
                                  <el-table-column
                                    type="index"
                                    width="50">
                                  </el-table-column>
                                  <el-table-column
                                    prop="studentCode"
                                    label="学籍号">
                                  </el-table-column>
                                  <el-table-column
                                    prop="memberName"
                                    label="学生姓名">
                                  </el-table-column>
                                  <el-table-column
                                    prop="className"
                                    label="班级名称">
                                  </el-table-column>
                                  <el-table-column
                                    prop="classType"
                                    label="班级类型">
                                  </el-table-column>
                                  <el-table-column
                                    prop="exciserNum"
                                    label="答题数">
                                  </el-table-column>
                                  <el-table-column
                                    prop="exciserTime"
                                    label="练习时长">
                                  </el-table-column>
                                  <el-table-column
                                    prop="rightRate"
                                    label="正确率">
                                  </el-table-column>
                                  <el-table-column
                                    prop="exciserAvg"
                                    label="平均答题时间">
                                  </el-table-column>
                                  <el-table-column
                                    label="操作"
                                    width="100">
                                    <template scope="scope">
                                      <el-button @click="addStudent()" type="text" size="small">加入学习小组</el-button>
                                    </template>
                                  </el-table-column>
                                </el-table>
                              </div>
                              <button id="btn_add" type="button" class="btn btn-primary"><i class="fa fa-check"></i>&nbsp;完成新建分组</button>
                          </div>
                      </div>
                    </div>
                </from>
            </div>
        </div>
    </div>
</div>

<% include ../footer.html %>
<script src="//cdn.bootcss.com/vue/2.2.1/vue.min.js"></script>
<script src="//cdn.bootcss.com/element-ui/1.2.4/index.js"></script>

<script>

$(document).ready(function () {
   $("#btn_add").click(function() {
       Edit();
       app.getStudentList();
    })
    group.getGrouoList();
 })

//打开编辑界面
function Edit() {
    layer_index = layer.open({
        type: 1,
        title: "新建分组",
        shadeClose: true,
        maxmin: true,
        area: ['100%', '100%'],
        content: $('#add_group_edit')
    });
}

var group = new Vue({
  el: '#group',
  data: {
    groupList: [],
    multipleSelection: []
  },
  methods: {
      handleSelectionChange:function(val) {
        this.multipleSelection = val;
      },
      getGrouoList: function() {
        var _self = this;
        $.ajax({
            type: "POST",
            url: teacher_server_url + "/groupController/getMemberGroupList.do",
            data: {teacherId:teacher_id},
            error: function (XMLHttpRequest, textStatus, errorThrown) {
                _toastr("error message : " + errorThrown.toString(), "bottom-right", "error", false);
            },
            success: function (obj) {
              var data = JSON.parse(obj);
                _self.groupList = data.data;
                if(data.returnCode != 0){
                  _toastr(data.returnMsg, "top-full-width", "error", false);
                }
            }
        });
      },
      deleteGroup:function() {
          console.log("shangchu fenzhu ");
      }
  }
})

var app = new Vue({
  el: '#app',
  data: {
    studentList: []
  },
  methods: {
    getStudentList:function() {
      var _self = this;
      $.ajax({
          type: "POST",
          url: teacher_server_url + "/groupController/getMembersForTest.do",
          data: {teacherId:teacher_id},
          error: function (XMLHttpRequest, textStatus, errorThrown) {
              _toastr("error message : " + errorThrown.toString(), "bottom-right", "error", false);
          },
          success: function (obj) {
            var data = JSON.parse(obj);
              _self.studentList = data.data;
              if(data.returnCode != 0){
                _toastr(data.returnMsg, "top-full-width", "error", false);
              }
          }
      });
    },
    addStudent:function() {

    }
  }
})
</script>
